{% extends "base.html.twig" %}

{% block title %}{{ "answer_form"|trans }} - {{ parent() }}{% endblock %}

{% block body %}

	<nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url("homepage") }}">{{ "homepage"|trans }}</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ "answer_form"|trans }}</li>
      </ol>
    </nav>
    
    {% for label, messages in app.flashes %}
    	{% if loop.index0 == 0 %}
    		<div class="position-relative overflow-hidden text-center bg-light" style="padding-left: 3rem !important; padding-top: 1rem !important; padding-right: 3rem !important; margin-left: 1rem !important; margin-top: 1rem !important; margin-right: 1rem !important;">
		{% endif %}
      	{% for message in messages %}
      		<div class="alert alert-{{ label }}" role="alert">{{ message|nl2br }}</div>
      	{% endfor %}
    	{% if loop.index0 == 0 %}
    		</div>
        {% endif %}
  	{% endfor %}
	
	{% if form_end is not empty and "now"|date("Y-m-d H:i:s") >= form_end|date("Y-m-d H:i:s") %}
		<div style="min-height: 300px;"><!-- The min height is used to avoid the footer to go up each time the user go to the next step -->
        
        	<div id="step1" class="px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
              <h1 class="display-5">{{ "answer_form"|trans }}</h1>
              <p class="lead">{{ "form_too_late"|trans }}</p>
            </div>
        </div>
    {% elseif form_start is not empty and "now"|date("Y-m-d H:i:s") < form_start|date("Y-m-d H:i:s") %}
		<div style="min-height: 300px;"><!-- The min height is used to avoid the footer to go up each time the user go to the next step -->
        
        	<div id="step1" class="px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
              <h1 class="display-5" style="font-family: Holiday;">{{ "answer_form"|trans }}</h1>
              <p class="lead">{{ "form_too_early"|trans({"%date%": form_start|date("Y-m-d H:i:s")|localizeddate("full", "short", locale, time_zone)}) }}</p>
            </div>
        </div>
	{% else %}
    
        <div class="container">
            <div class="progress">
        		<div id="progress" class="progress-bar bg-success" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
        	</div>
    	</div>
    	
    	
        {% if electoralList is not null %}
        	<div class="px-3 py-3 pt-md-5 pb-md-4 mx-auto">
                
                <center>
              		<h1 class="display-5">{{ "overview"|trans }}</h1>
              		<p class="lead">{{ "overview_hint"|trans|nl2br }}</p>
              	</center>
              	
          		<div class="alert alert-warning" role="alert" id="warning_overview" style="display: none;"></div>
              	
              	<p class="lead"><em>{{ "general_informations"|trans }}</em> <a href="{{ url("answer_form", {"draft": electoralList.draftId}) }}">{{ "modify"|trans }}</a></p>
				
				<center>
					<p><strong>{{ "question_step3"|trans }}</strong></p>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm" style="max-width: 600px;">
                        	<tr>
                        		<td><strong>{{ "city"|trans }}</strong></td>
                        		<td>{{ electoralList.city.name }}</td>
                        	</tr>
                        	<tr>
                        		<td><strong>{{ "heads_of_list"|trans }}</strong></td>
                        		<td>
                        			<ul>
                        				<li>{{ electoralList.firstnameHeadOfList1 }} {{ electoralList.lastnameHeadOfList1 }}</li>
                        				<li>{{ electoralList.firstnameHeadOfList2 }} {{ electoralList.lastnameHeadOfList2 }}</li>
                        			</ul>
                        		</td>
                        	</tr>
                        	<tr>
                        		<td><strong>{{ "form_supported_by_hint"|trans }}</strong></td>
                        		<td>{{ electoralList.supportedBy }}</td>
                        	</tr>
                        </table>
    				</div>
				</center>
              	
              	
              	<center>
					<p><strong>{{ "question_step4"|trans }}</strong></p>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm" style="max-width: 600px;">
                        	<tr>
                        		<td><strong>{{ "name"|trans }}</strong></td>
                        		<td>{{ electoralList.contactFirstname }} {{ electoralList.contactLastname }}</td>
                        	</tr>
                        	<tr>
                        		<td><strong>{{ "role"|trans }}</strong></td>
                        		<td>{{ electoralList.contactRole }}</td>
                        	</tr>
                        	<tr>
                        		<td><strong>{{ "contacts"|trans }}</strong></td>
                        		<td>{{ electoralList.contactPhone }}<br>
                        		{{ electoralList.contactEmail }}
                        		</td>
                        	</tr>
                        </table>								
                    </div>
                </center>
              	
              	<p class="lead"><em>{{ "admin_answers"|trans }}</em> <a href="{{ url("answer_form_questions", {"step": 1, "draft": electoralList.draftId}) }}">{{ "modify"|trans }}</a></p>
              	
              	
              	
				<p><strong><em>{{ "ask_question_beginning"|trans }}</em></strong></p>
				
              	<center>
					
            	    {% for answer in electoralList.answers %}
                        <div class="table-responsive">
                            <table class="table table-striped table-sm">
                            	<tr>
                            		<td style="max-width: 50%;"><em><strong>...{{ answer.question.text }}</strong></em></td>
                            		<td style="max-width: 50%;">{{ ("answer_value_"~answer.value)|trans }}</td>
                            	</tr>
                            	{% if answer.text is not empty %}
                            	<tr>
                            		<td style="max-width: 50%;"><strong>{{ "answer"|trans }}</strong></td>
                            		<td style="max-width: 50%;">{{ answer.text }}</td>
                            	</tr>
                            	{% endif %}
                            </table>								
                        </div>
                        
                        <hr>
                    {% endfor %}
                </center>
                
                
                <p>
                    <center>
                    	<form method="post" action="{{ url("answer_form_overview", {"draft": electoralList.draftId}) }}">
                        	<button type="submit" class="btn btn-ok-final">{{ "submit"|trans }}</span>
                    	</form>
                    </center>
                </p>
            </div>
        {% endif %}
    {% endif %}
{% endblock %}

{% block js %}
    <script type="application/javascript">
        $(function() {
        	$("#progress").addClass("w-90");
        });
    </script>
{% endblock %}
